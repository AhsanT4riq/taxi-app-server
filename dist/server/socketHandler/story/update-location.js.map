{"version":3,"sources":["server/socketHandler/story/update-location.js"],"names":["updateLocationHandler","socket","on","userType","userObj","searchObj","riderId","_id","driverId","userID","findOneAndUpdateAsync","$set","gpsLoc","new","then","emitByUserId","updatedUser","findOneAsync","$and","$or","tripRequestStatus","tripRequestObj","driverObj","changedTripRequestStatus","tripStatus","tripObj","error","e","dist","srcLoc","newTripRequestStatus","currentTripRequestStatus","toFixed","console","log","arrivedDistance","arrivingDistance","updatedTripRequestObj","updatedTripRequestObj123","message","data","err"],"mappings":"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","file":"update-location.js","sourceRoot":"../../../../../../.."}